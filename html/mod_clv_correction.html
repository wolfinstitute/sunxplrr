<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Fits the clv function, calibrate it and flattens the image</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mod_clv_correction {sunxplrr}"><tr><td>mod_clv_correction {sunxplrr}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Fits the clv function, calibrate it and flattens the image</h2>

<h3>Description</h3>

<p>Fits a six parameter polynom to the limb-variation-function.
Additionnally, a plane may be fitted trough the center of the image disc.
Removes all fitted non clv variation from the image and flattens it to
intensity contrasts. Be aware, that the resulting intensity contrast values
should be multiplied with some appropriate factor before converting them
back to FITS, since in the FITS image all values are treated as integers.
</p>


<h3>Usage</h3>

<pre>
mod_clv_correction(x, hdrlst, header, model = "poly_with_plane",
  run = 3, clip.resid.out = "FALSE", sclv.method = "NL",
  sdo.image = "FALSE", light.save = "FALSE")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>tibble containing columns wih pixel coordinates i and j and all
the calculated image information as provided by the disc extraction module.</p>
</td></tr>
<tr valign="top"><td><code>hdrlst</code></td>
<td>
<p>list containing image FITS header keywords and values.</p>
</td></tr>
<tr valign="top"><td><code>header</code></td>
<td>
<p>list containing image FITS header.</p>
</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
<p>implemented are &quot;poly&quot; for polynomial fit with 6 coefficients,
&quot;poly_with_plane&quot; for polynomial fit with 6 coefficients and an additional
2 parameter plane through the disc center and a third model named as
&quot;poly_with_plane_and nonparametric background&quot; for polynomial fit with
6 coefficients, an additional 2 parameter plane and a nonparametric surface
fit in a gam structure.</p>
</td></tr>
<tr valign="top"><td><code>run</code></td>
<td>
<p>indicates how many iterations for spot and faculae elimination
should be run. No more than 3 iterations are implemented.</p>
</td></tr>
<tr valign="top"><td><code>clip.resid.out</code></td>
<td>
<p>if &quot;TRUE&quot; the clipped residuals from the last fit
iteration are returned. In batch mode this output is not needed.</p>
</td></tr>
<tr valign="top"><td><code>sdo.image</code></td>
<td>
<p>boolean switch for dummy use in the case of non sdo calcium
images.</p>
</td></tr>
<tr valign="top"><td><code>light.save</code></td>
<td>
<p>if TRUE only a small selection of csv files are saved.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble containing clv function, calib image and flat image.
</p>


<h3>Author(s)</h3>

<p>[Thomas K. Friedli](mailto:thomas.friedli@bluewin.ch)
</p>

<hr /><div style="text-align: center;">[Package <em>sunxplrr</em> version 0.1.0 <a href="00Index.html">Index</a>]</div>
</body></html>
